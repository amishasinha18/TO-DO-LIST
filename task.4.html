<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Smart To-Do Magic</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0; padding: 40px 15px;
      font-family: 'Quicksand', sans-serif;
      background: linear-gradient(270deg, #ffecd2, #fcb69f, #ff9a9e, #fad0c4, #fcb69f);
      background-size: 1000% 1000%;
      animation: gradientShift 15s ease infinite;
      display: flex; justify-content: center;
    }

    @keyframes gradientShift {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }

    .container {
      width: 100%; max-width: 800px;
      display: flex; flex-direction: column; gap: 30px;
    }

    .box {
      background: rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(20px);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
      transition: all 0.5s;
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 24px;
    }

    input, select, button {
      width: 100%; padding: 12px; margin-top: 10px;
      font-size: 15px; border-radius: 12px; border: none;
      outline: none;
      background: rgba(255, 255, 255, 0.5);
      transition: background 0.3s, transform 0.2s;
    }

    input:focus, select:focus {
      background: rgba(255, 255, 255, 0.7);
    }

    button {
      background: linear-gradient(135deg, #ff9a9e, #fad0c4);
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(255, 154, 158, 0.4);
    }

    button:hover {
      transform: translateY(-2px);
    }

    .clear-btn {
      background: linear-gradient(135deg, #f5576c, #f093fb);
    }

    .clear-btn:hover {
      transform: translateY(-2px);
    }

    .filters button {
      margin: 5px 5px 0 0;
      padding: 8px 15px;
      font-size: 13px;
      border: none;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: transform 0.2s, background 0.3s;
    }

    .filters button.active {
      background: #ff9a9e;
      color: #fff;
    }

    ul { list-style: none; padding: 0; margin-top: 15px; }
    li {
      background: rgba(255, 255, 255, 0.4);
      margin-bottom: 10px; padding: 15px;
      border-radius: 15px;
      transition: all 0.5s;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      border: 2px solid transparent;
      animation: fadeIn 0.5s ease forwards;
    }

    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(10px);}
      to {opacity: 1; transform: translateY(0);}
    }

    li:hover {
      border-image: linear-gradient(45deg, #ff9a9e, #fad0c4) 1;
      transform: translateY(-3px);
    }

    li.done {
      text-decoration: line-through;
      opacity: 0.7;
    }

    .meta {
      font-size: 12px; color: #2d3436; display: flex; gap: 15px; flex-wrap: wrap;
    }

    .btns {
      margin-top: 8px;
      display: flex;
      gap: 6px;
    }

    .btns button {
      font-size: 16px; padding: 5px 10px;
      background: rgba(0,0,0,0.1);
      border-radius: 8px;
    }

    .priority-high { color: red; font-weight: bold; }
    .priority-medium { color: orange; }
    .priority-low { color: green; }

    .category-General::before { content: "üìÑ "; }
    .category-Work::before { content: "üíº "; }
    .category-Personal::before { content: "üè† "; }
    .category-Urgent::before { content: "‚ö° "; }

    .overdue { border: 2px solid red; }

    #counter {
      text-align: center;
      font-weight: bold;
      margin-top: 10px;
    }

    #progress-bar {
      height: 10px; border-radius: 5px; background: #ddd; margin-top: 5px; overflow: hidden;
    }

    #progress-inner {
      height: 100%; width: 0%; background: #ff9a9e; border-radius: 5px; transition: width 0.5s;
    }
  </style>
</head>
<body>
<div class="container">
  <div class="box">
    <h2>‚ú® Smart To-Do Magic</h2>
    <div class="row">
      <input id="task" placeholder="Task...">
      <input id="time" type="datetime-local">
    </div>
    <div class="row">
      <select id="category">
        <option>General</option><option>Work</option>
        <option>Personal</option><option>Urgent</option>
      </select>
      <select id="priority">
        <option value="low">Low</option>
        <option value="medium">Medium</option>
        <option value="high">High</option>
      </select>
    </div>
    <button onclick="addTask()">Add Task</button>
    <input type="text" placeholder="Search task..." oninput="search = this.value; render();">
    <div class="filters">
      <button id="filter-all" class="active" onclick="setFilter('all')">All</button>
      <button id="filter-pending" onclick="setFilter('pending')">Pending</button>
      <button id="filter-completed" onclick="setFilter('completed')">Completed</button>
    </div>
    <ul id="list"></ul>
    <div id="counter"></div>
    <div id="progress-bar"><div id="progress-inner"></div></div>
  </div>

  <div class="box">
    <h2>‚úÖ Completed</h2>
    <ul id="completed"></ul>
    <button class="clear-btn" onclick="clearCompleted()">Clear All Completed</button>
  </div>
</div>

<script>
  let filter = 'all', search = '';

  const getTasks = () => JSON.parse(localStorage.getItem("tasks") || "[]");
  const saveTasks = tasks => localStorage.setItem("tasks", JSON.stringify(tasks));

  function addTask() {
    const taskInput = document.getElementById("task");
    const timeInput = document.getElementById("time");
    const categoryInput = document.getElementById("category");
    const priorityInput = document.getElementById("priority");

    const text = taskInput.value.trim();
    const time = timeInput.value;
    const category = categoryInput.value;
    const priority = priorityInput.value;
    if (!text) return alert("Enter a task!");

    const tasks = getTasks();
    tasks.push({ text, time, category, priority, completed: false });
    saveTasks(tasks);

    taskInput.value = "";
    timeInput.value = "";
    categoryInput.selectedIndex = 0;
    priorityInput.selectedIndex = 0;

    render();
  }

  function render() {
    const all = getTasks().filter(t => t.text.toLowerCase().includes(search.toLowerCase()));
    const filtered = all.filter(t => filter === 'all' ? true : filter === 'pending' ? !t.completed : t.completed);
    const list = document.getElementById("list"), done = document.getElementById("completed");
    list.innerHTML = done.innerHTML = "";

    filtered.sort((a, b) => new Date(a.time || 0) - new Date(b.time || 0));

    all.forEach((t, i) => {
      const el = document.createElement("li");
      if (t.completed) el.classList.add("done");
      el.classList.add(`category-${t.category}`);

      const now = new Date();
      if (t.time && !t.completed && new Date(t.time) < now) {
        el.classList.add("overdue");
      }

      el.innerHTML = `
        <div><strong>${t.text}</strong></div>
        <div class="meta">
          <span>${t.category}</span>
          <span class="priority-${t.priority}">Priority: ${t.priority}</span>
          <span>${t.time || ""}</span>
        </div>
        <div class="btns">
          ${!t.completed ? `<button onclick="complete(${i})">‚úÖ</button>` : ""}
          <button onclick="remove(${i})">üóëÔ∏è</button>
        </div>
      `;
      (t.completed ? done : list).appendChild(el);
    });

    const completedCount = all.filter(t => t.completed).length;
    document.getElementById("counter").textContent =
      `Progress: ${completedCount}/${all.length} tasks completed`;

    const progress = all.length ? (completedCount / all.length) * 100 : 0;
    document.getElementById("progress-inner").style.width = progress + "%";
  }

  function complete(i) {
    const tasks = getTasks();
    tasks[i].completed = true;
    saveTasks(tasks);
    render();
    showConfetti();
  }

  function remove(i) {
    const tasks = getTasks();
    tasks.splice(i, 1);
    saveTasks(tasks);
    render();
  }

  function clearCompleted() {
    saveTasks(getTasks().filter(t => !t.completed));
    render();
  }

  function setFilter(f) {
    filter = f;
    document.querySelectorAll(".filters button").forEach(btn => btn.classList.remove("active"));
    document.getElementById(`filter-${f}`).classList.add("active");
    render();
  }

  function showConfetti() {
    const confetti = document.createElement("div");
    confetti.textContent = "üéâ";
    confetti.style.position = "fixed";
    confetti.style.left = Math.random() * 100 + "vw";
    confetti.style.top = "0";
    confetti.style.fontSize = "2rem";
    confetti.style.animation = "drop 1s ease forwards";
    document.body.appendChild(confetti);

    setTimeout(() => confetti.remove(), 1000);
  }

  window.onload = render;
</script>
<style>
@keyframes drop {
  to { transform: translateY(100vh); opacity: 0; }
}
</style>
</body>
</html>
